import{r as h,a as C,b as E,q as V,K as L,M,N as B,j as e,f as v,X as k,u as b}from"./index-CSY5YgiJ.js";import{N as D}from"./Navbar-eeXt84en.js";import{B as f,C as g}from"./card-dyY2Qvrr.js";import{S as F,a as I,b as $,c as G,d}from"./select-CjlLjNwJ.js";import{R as i}from"./RatingStars-tsFfm_V7.js";import{z as T}from"./proxy-BCkhZuQv.js";import{M as y}from"./map-pin-C4YDvCp_.js";import"./index-Q8Z8E6D0.js";import"./Combination-CrH4g3RK.js";const Y=()=>{const[w,S]=h.useState({}),[j,N]=h.useState("pending"),o=C(),{data:n}=E(),{data:A}=V(),{data:u=[],isLoading:P,refetch:_}=L(),{data:l=[],isLoading:R}=M(),r=B(),c=n==null?void 0:n.user,x=P||R;h.useEffect(()=>{l.length>0&&console.log("Approved users with ratings:",l.map(s=>({name:s.name,rating:s.rating,verification_status:s.verification_status})))},[l]),h.useEffect(()=>{var a;const s=!!localStorage.getItem("token");s&&!x&&!n||!s&&!x?o("/auth"):n&&c&&!((a=c==null?void 0:c.roles)!=null&&a.includes("admin"))&&o("/dashboard")},[n,c,x,o]);const p=async(s,a,t)=>{try{await r.mutateAsync({id:s,verification_status:a,rating:t}),b.success(`Profile ${a}${t?` with ${t} star rating`:""}`),_()}catch(m){console.error("Error verifying profile:",m),b.error(m.message||"An error occurred")}};return x?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(v,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"min-h-screen",children:[e.jsx(D,{user:c,profile:A}),e.jsx("div",{className:"container mx-auto px-4 pt-24 pb-12",children:e.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-8",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold red-glow-intense mb-2",children:"Studio Approvals"}),e.jsx("p",{className:"text-muted-foreground",children:"Review and manage studio registrations"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:j==="pending"?"default":"outline",onClick:()=>N("pending"),children:["Pending (",u.length,")"]}),e.jsxs(f,{variant:j==="approved"?"default":"outline",onClick:()=>N("approved"),children:["Approved (",l.length,")"]})]})]})}),j==="pending"?u.length===0?e.jsx(g,{className:"p-12 text-center border-dashed",children:e.jsx("p",{className:"text-muted-foreground",children:"No pending verifications at this time"})}):e.jsx("div",{className:"space-y-6",children:u.map(s=>e.jsx(g,{className:"p-6 border-red-glow",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold mb-1",children:s.name}),e.jsx("p",{className:"text-muted-foreground",children:s.email})]}),s.location&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(y,{className:"h-4 w-4"}),s.location]}),s.bio&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-1",children:"Bio"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.bio})]}),s.associations&&s.associations.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Associations"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.associations.map((a,t)=>e.jsx("span",{className:"text-xs px-2 py-1 bg-primary/10 text-primary rounded",children:a},t))})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Registered: ",new Date(s.createdAt||s.created_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Assign Rating"}),e.jsxs(F,{value:w[s._id]||"",onValueChange:async a=>{const t=parseInt(a);await p(s._id,"approved",t),S(m=>({...m,[s._id]:""}))},disabled:r.isPending,children:[e.jsx(I,{className:"border-border",disabled:r.isPending,children:e.jsx($,{placeholder:r.isPending?"Processing...":"Select rating and approve"})}),e.jsxs(G,{children:[e.jsx(d,{value:"5",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{rating:5}),e.jsx("span",{className:"text-xs",children:"- Global Elite"})]})}),e.jsx(d,{value:"4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{rating:4}),e.jsx("span",{className:"text-xs",children:"- Premier"})]})}),e.jsx(d,{value:"3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{rating:3}),e.jsx("span",{className:"text-xs",children:"- Verified"})]})}),e.jsx(d,{value:"2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{rating:2}),e.jsx("span",{className:"text-xs",children:"- Approved"})]})}),e.jsx(d,{value:"1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{rating:1}),e.jsx("span",{className:"text-xs",children:"- Entry Level"})]})})]})]})]}),e.jsx(f,{variant:"destructive",className:"w-full",onClick:()=>p(s._id,"rejected"),disabled:r.isPending,children:r.isPending?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Reject Application"]})})]})]})},s._id))}):e.jsx("div",{className:"space-y-6",children:l.length===0?e.jsx(g,{className:"p-12 text-center border-dashed",children:e.jsx("p",{className:"text-muted-foreground",children:"No approved studios yet"})}):e.jsx(e.Fragment,{children:l.map(s=>e.jsx(g,{className:"p-6 border-green-500",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold mb-1",children:s.name}),e.jsx("p",{className:"text-muted-foreground",children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"bg-green-500/20 text-green-400 px-3 py-1 rounded-full text-sm font-semibold",children:"Approved"}),s.rating?e.jsx(i,{rating:s.rating,showBadge:!0}):e.jsx("span",{className:"text-xs text-muted-foreground",children:"No rating"})]})]}),s.location&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(y,{className:"h-4 w-4"}),s.location]}),s.bio&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-1",children:"Bio"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.bio})]}),s.associations&&s.associations.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Associations"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.associations.map((a,t)=>e.jsx("span",{className:"text-xs px-2 py-1 bg-primary/10 text-primary rounded",children:a},t))})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Approved: ",s.updatedAt?new Date(s.updatedAt).toLocaleDateString():"N/A"]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"p-4 bg-green-500/10 border border-green-500/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-sm font-semibold",children:"Rating:"}),s.rating?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{rating:s.rating,showBadge:!1}),e.jsxs("span",{className:"text-sm text-foreground font-bold",children:[s.rating,"/5"]})]}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"Not rated"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Status: ",s.verification_status]}),s.rating&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[s.rating===5&&"Global Elite Studio",s.rating===4&&"Premier Studio",s.rating===3&&"Verified Studio",s.rating===2&&"Approved Studio",s.rating===1&&"Entry Level Studio"]})]})})]})},s._id))})})]})})]})};export{Y as default};
