import{a as me,r as m,b as he,H as ue,j as e,f as H,X as xe,u as x}from"./index-CSY5YgiJ.js";import{u as pe,t as je}from"./zod-d7-ns2YA.js";import{N as ge}from"./Navbar-eeXt84en.js";import{C as E,a as I,b as R,c as A,B as z}from"./card-dyY2Qvrr.js";import{I as o}from"./input-bM4iH4pw.js";import{T as se}from"./textarea-BOa-INnI.js";import{L as j}from"./label-Bz9P5vOH.js";import{F as fe,a as y,b as w,c as v,d as b,e as S,P as ye,f as we}from"./progress-z9G0hppw.js";import{S as ve,a as be,b as Se,c as Ce,d as re}from"./select-CjlLjNwJ.js";import{z as _e}from"./proxy-BCkhZuQv.js";import{P as Ne}from"./plus-35letP8-.js";import{o as Fe,s as B,e as Me}from"./types-L2k3iFj2.js";import"./index-Q8Z8E6D0.js";import"./Combination-CrH4g3RK.js";const ze=Fe({title:B().min(3,"Title must be at least 3 characters"),description:B().optional(),tagline:B().optional(),showreel_type:Me(["embed","upload"]).optional(),showreel_url:B().optional(),journey_content:B().optional()}),Ye=()=>{const C=me(),[_,L]=m.useState(!1),[V,Be]=m.useState(0),[W,ae]=m.useState(""),[$,te]=m.useState(""),[p,oe]=m.useState(null),[N,Y]=m.useState([]),[D,J]=m.useState(""),[c,P]=m.useState({twitter:"",linkedin:"",instagram:"",website:""}),[g,O]=m.useState({primary:"#ef4444",secondary:"#1a1a1a"}),i=pe({resolver:je(ze),defaultValues:{title:"",description:"",tagline:"",showreel_type:"embed",showreel_url:"",journey_content:""}}),{data:F,isLoading:k}=he(),le=ue(),X=F==null?void 0:F.user;m.useEffect(()=>{const s=!!localStorage.getItem("token");(!k&&!F&&s||!s&&!k)&&C("/auth")},[k,F,C]);const ie=async s=>{var h;const a=(h=s.target.files)==null?void 0:h[0];if(!a)return;const t=10,f=t*1024*1024;if(a.size>f){x.error(`Logo image is too large. Maximum file size is ${t}MB. Current file: ${(a.size/(1024*1024)).toFixed(2)}MB`),s.target.value="";return}const l=new FileReader;l.onloadend=()=>{ae(l.result)},l.onerror=()=>{x.error("Failed to read logo image file")},l.readAsDataURL(a)},ne=async s=>{var h;const a=(h=s.target.files)==null?void 0:h[0];if(!a)return;const t=10,f=t*1024*1024;if(a.size>f){x.error(`Hero image is too large. Maximum file size is ${t}MB. Current file: ${(a.size/(1024*1024)).toFixed(2)}MB`),s.target.value="";return}const l=new FileReader;l.onloadend=()=>{te(l.result)},l.onerror=()=>{x.error("Failed to read hero image file")},l.readAsDataURL(a)},ce=s=>{var t;const a=(t=s.target.files)==null?void 0:t[0];a&&oe(a)},K=()=>{D.trim()&&(Y([...N,D.trim()]),J(""))},de=s=>{Y(N.filter((a,t)=>t!==s))},q=async(s,a)=>{var t,f,l,h,Q,Z,ee;if(X){L(!0);try{const n=W||"",u=$||"";let d=s.showreel_url;if(p&&s.showreel_type==="upload"){if(p.size>52428800){x.error(`Showreel video is too large. Maximum file size is 50MB. Current file: ${(p.size/(1024*1024)).toFixed(2)}MB`),L(!1);return}const M=new FileReader;try{d=await new Promise((T,U)=>{M.onloadend=()=>{M.result?T(M.result):U(new Error("Failed to read video file"))},M.onerror=()=>{U(new Error("Failed to read video file"))},M.readAsDataURL(p)})}catch(T){const U=T instanceof Error?T.message:"Failed to convert video to base64";x.error(U),L(!1);return}}const r={title:s.title,published:a};(t=s.description)!=null&&t.trim()&&(r.description=s.description.trim()),(f=s.tagline)!=null&&f.trim()&&(r.tagline=s.tagline.trim()),n&&n.trim()&&(r.logo_url=n),u&&u.trim()&&(r.hero_media_url=u,r.hero_media_type="image"),d!=null&&d.trim()&&(r.showreel_url=d.trim(),r.showreel_type=s.showreel_type||"embed"),(l=s.journey_content)!=null&&l.trim()&&(r.journey_content=s.journey_content.trim()),Object.keys(g).length>0&&(r.brand_colors=g),Object.values(c).some(G=>G&&G.trim())&&(r.social_links=c),N.length>0&&(r.awards=N),console.log("Creating wall with payload:",{...r,logo_url:r.logo_url&&typeof r.logo_url=="string"?`${r.logo_url.substring(0,50)}...`:"empty",hero_media_url:r.hero_media_url&&typeof r.hero_media_url=="string"?`${r.hero_media_url.substring(0,50)}...`:"empty",showreel_url:r.showreel_url&&typeof r.showreel_url=="string"?`${r.showreel_url.substring(0,50)}...`:"empty"}),await le.mutateAsync(r),x.success(a?"Wall published successfully!":"Wall saved as draft!"),C("/dashboard")}catch(n){console.error("Error creating wall:",n);let u="Failed to create wall";if(n&&typeof n=="object"&&"response"in n){const d=n;(Q=(h=d.response)==null?void 0:h.data)!=null&&Q.error?u=d.response.data.error:(ee=(Z=d.response)==null?void 0:Z.data)!=null&&ee.message&&(u=d.response.data.message)}else n instanceof Error&&(u=n.message);x.error(u)}finally{L(!1)}}};return k?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(H,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ge,{user:X}),e.jsx("div",{className:"container mx-auto px-4 pt-24 pb-12",children:e.jsxs(_e.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-4xl mx-auto space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold red-glow-intense mb-2",children:"Create Your Wall"}),e.jsx("p",{className:"text-muted-foreground",children:"Build your digital presence and showcase your work"})]}),e.jsx(fe,{...i,children:e.jsxs("form",{className:"space-y-6",children:[e.jsxs(E,{children:[e.jsx(I,{children:e.jsx(R,{children:"Basic Information"})}),e.jsxs(A,{className:"space-y-4",children:[e.jsx(y,{control:i.control,name:"title",render:({field:s})=>e.jsxs(w,{children:[e.jsx(v,{children:"Wall Title *"}),e.jsx(b,{children:e.jsx(o,{placeholder:"Enter wall title",...s})}),e.jsx(S,{})]})}),e.jsx(y,{control:i.control,name:"description",render:({field:s})=>e.jsxs(w,{children:[e.jsx(v,{children:"Description"}),e.jsx(b,{children:e.jsx(se,{placeholder:"Describe your wall...",rows:4,...s})}),e.jsx(S,{})]})}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"hero",children:"Hero Image"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Maximum file size: 10MB. Supported formats: JPG, PNG, GIF, WebP"}),e.jsx(o,{id:"hero",name:"hero",type:"file",accept:"image/*",onChange:ne,className:"mt-2"}),$&&e.jsx("img",{src:$,alt:"Hero preview",className:"mt-4 rounded-lg max-h-48 object-cover"})]})]})]}),e.jsxs(E,{children:[e.jsx(I,{children:e.jsx(R,{children:"Studio Identity"})}),e.jsxs(A,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"logo",children:"Logo"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Maximum file size: 10MB. Supported formats: JPG, PNG, GIF, WebP, SVG"}),e.jsx(o,{id:"logo",name:"logo",type:"file",accept:"image/*",onChange:ie,className:"mt-2"}),W&&e.jsx("img",{src:W,alt:"Logo preview",className:"mt-4 h-24 w-auto object-contain"})]}),e.jsx(y,{control:i.control,name:"tagline",render:({field:s})=>e.jsxs(w,{children:[e.jsx(v,{children:"Tagline"}),e.jsx(b,{children:e.jsx(o,{placeholder:"Your studio's tagline",...s})}),e.jsx(S,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"primary-color",children:"Primary Color"}),e.jsx(o,{id:"primary-color",type:"color",value:g.primary,onChange:s=>O({...g,primary:s.target.value}),className:"h-10 mt-2"})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"secondary-color",children:"Secondary Color"}),e.jsx(o,{id:"secondary-color",type:"color",value:g.secondary,onChange:s=>O({...g,secondary:s.target.value}),className:"h-10 mt-2"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Social Links"}),e.jsx(o,{placeholder:"Twitter URL",value:c.twitter,onChange:s=>P({...c,twitter:s.target.value})}),e.jsx(o,{placeholder:"LinkedIn URL",value:c.linkedin,onChange:s=>P({...c,linkedin:s.target.value})}),e.jsx(o,{placeholder:"Instagram URL",value:c.instagram,onChange:s=>P({...c,instagram:s.target.value})}),e.jsx(o,{placeholder:"Website URL",value:c.website,onChange:s=>P({...c,website:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Awards & Certifications"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{placeholder:"Add an award...",value:D,onChange:s=>J(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),K())}),e.jsx(z,{type:"button",onClick:K,size:"sm",children:e.jsx(Ne,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"space-y-2",children:N.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-secondary rounded",children:[e.jsx("span",{className:"text-sm",children:s}),e.jsx(z,{type:"button",variant:"ghost",size:"sm",onClick:()=>de(a),children:e.jsx(xe,{className:"h-4 w-4"})})]},a))})]})]})]}),e.jsxs(E,{children:[e.jsx(I,{children:e.jsx(R,{children:"Main Showreel"})}),e.jsxs(A,{className:"space-y-4",children:[e.jsx(y,{control:i.control,name:"showreel_type",render:({field:s})=>e.jsxs(w,{children:[e.jsx(v,{children:"Showreel Type"}),e.jsxs(ve,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(b,{children:e.jsx(be,{children:e.jsx(Se,{placeholder:"Select type"})})}),e.jsxs(Ce,{children:[e.jsx(re,{value:"embed",children:"Embed URL (YouTube/Vimeo)"}),e.jsx(re,{value:"upload",children:"Upload Video"})]})]}),e.jsx(S,{})]})}),i.watch("showreel_type")==="embed"&&e.jsx(y,{control:i.control,name:"showreel_url",render:({field:s})=>e.jsxs(w,{children:[e.jsx(v,{children:"Video URL"}),e.jsx(b,{children:e.jsx(o,{placeholder:"https://youtube.com/...",...s})}),e.jsx(S,{})]})}),i.watch("showreel_type")==="upload"&&e.jsxs("div",{children:[e.jsx(j,{htmlFor:"showreel",children:"Upload Video"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Maximum file size: 50MB. Supported formats: MP4, WebM, MOV, AVI"}),e.jsx(o,{id:"showreel",type:"file",accept:"video/*",onChange:ce,className:"mt-2"}),p&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Selected: ",p.name," (",(p.size/(1024*1024)).toFixed(2)," MB)"]}),V>0&&V<100&&e.jsx(ye,{value:V,className:"mt-2"})]})]})]}),e.jsxs(E,{children:[e.jsx(I,{children:e.jsx(R,{children:"Studio Journey"})}),e.jsx(A,{children:e.jsx(y,{control:i.control,name:"journey_content",render:({field:s})=>e.jsxs(w,{children:[e.jsx(v,{children:"Your Story"}),e.jsx(we,{children:"Example (2020: Founded VFX Studios with a vision to revolutionize visual effects)"}),e.jsx(b,{children:e.jsx(se,{placeholder:"Tell your studio's story, milestones, and journey...",rows:6,...s})}),e.jsx(S,{})]})})})]}),e.jsxs("div",{className:"flex gap-4 justify-end",children:[e.jsx(z,{type:"button",variant:"outline",onClick:()=>C("/dashboard"),disabled:_,children:"Cancel"}),e.jsx(z,{type:"button",variant:"outline",onClick:()=>i.handleSubmit(s=>q(s,!1))(),disabled:_,children:_?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):"Save as Draft"}),e.jsx(z,{type:"button",onClick:()=>i.handleSubmit(s=>q(s,!0))(),disabled:_,children:_?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Publish Wall"})]})]})})]})})]})};export{Ye as default};
