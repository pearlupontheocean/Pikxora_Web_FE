import{a as M,b as T,q as D,O as V,r as d,j as s,f as _,X as $,u as g}from"./index-CSY5YgiJ.js";import{N as q}from"./Navbar-eeXt84en.js";import{C as h,a as x,b as u,c as j,B as f}from"./card-dyY2Qvrr.js";import{I as n}from"./input-bM4iH4pw.js";import{T as H}from"./textarea-BOa-INnI.js";import{L as t}from"./label-Bz9P5vOH.js";import{R as K}from"./RatingStars-tsFfm_V7.js";import{z as O}from"./proxy-BCkhZuQv.js";import{P as W}from"./plus-35letP8-.js";const is=()=>{const p=M(),{data:m,isLoading:y}=T(),{data:i,isLoading:R}=D(),B=V(),[a,r]=d.useState({location:"",bio:"",associations:[],social_links:{twitter:"",linkedin:"",instagram:"",website:""},brand_colors:{primary:"#ef4444",secondary:"#1a1a1a"},avatar_url:""}),[b,k]=d.useState(""),[w,C]=d.useState(""),[N,S]=d.useState(!1),U=m==null?void 0:m.user,A=y||R;if(d.useEffect(()=>{const e=!!localStorage.getItem("token");!y&&!m&&!e&&p("/auth")},[y,m,p]),A)return s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx(_,{className:"h-8 w-8 animate-spin text-primary"})});d.useEffect(()=>{i&&(r({location:i.location||"",bio:i.bio||"",associations:i.associations||[],social_links:i.social_links||{twitter:"",linkedin:"",instagram:"",website:""},brand_colors:i.brand_colors||{primary:"#ef4444",secondary:"#1a1a1a"},avatar_url:i.avatar_url||""}),C(i.avatar_url||""))},[i]);const E=e=>{var F;const l=(F=e.target.files)==null?void 0:F[0];if(!l)return;const c=50,o=c*1024*1024;if(l.size>o){g.error(`Avatar image is too large. Maximum file size is ${c}MB.`),e.target.value="";return}const v=new FileReader;v.onloadend=()=>{const P=v.result;C(P),r({...a,avatar_url:P})},v.onerror=()=>{g.error("Failed to read avatar image file")},v.readAsDataURL(l)},L=()=>{b.trim()&&(r({...a,associations:[...a.associations,b.trim()]}),k(""))},z=e=>{r({...a,associations:a.associations.filter((l,c)=>c!==e)})},I=async e=>{var l,c;e.preventDefault(),S(!0);try{await B.mutateAsync({location:a.location,bio:a.bio,associations:a.associations,social_links:a.social_links,brand_colors:a.brand_colors,avatar_url:a.avatar_url}),g.success("Profile updated successfully!"),p("/dashboard")}catch(o){g.error(((c=(l=o==null?void 0:o.response)==null?void 0:l.data)==null?void 0:c.error)||(o==null?void 0:o.message)||"Failed to update profile")}finally{S(!1)}};return A?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx(_,{className:"h-8 w-8 animate-spin text-primary"})}):s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(q,{user:U,profile:i}),s.jsx("div",{className:"container mx-auto px-4 pt-24 pb-12",children:s.jsxs(O.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-4xl mx-auto space-y-8",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-4xl font-bold red-glow-intense mb-2",children:"Profile Settings"}),s.jsx("p",{className:"text-muted-foreground",children:"Update your profile information"})]}),s.jsxs(h,{children:[s.jsx(x,{children:s.jsx(u,{children:"Profile Information"})}),s.jsx(j,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(t,{children:"Name"}),s.jsx(n,{value:(i==null?void 0:i.name)||"",disabled:!0,className:"mt-2"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Name cannot be changed"})]}),s.jsxs("div",{children:[s.jsx(t,{children:"Email"}),s.jsx(n,{value:(i==null?void 0:i.email)||"",disabled:!0,className:"mt-2"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Email cannot be changed"})]}),(i==null?void 0:i.rating)&&s.jsxs("div",{children:[s.jsx(t,{children:"Rating"}),s.jsx("div",{className:"mt-2",children:s.jsx(K,{rating:i.rating,showBadge:!0})}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Rating is assigned by admin"})]}),(i==null?void 0:i.verification_status)&&s.jsxs("div",{children:[s.jsx(t,{children:"Verification Status"}),s.jsx("div",{className:"mt-2",children:s.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${i.verification_status==="approved"?"bg-green-500/20 text-green-400":i.verification_status==="pending"?"bg-yellow-500/20 text-yellow-400":"bg-red-500/20 text-red-400"}`,children:i.verification_status.charAt(0).toUpperCase()+i.verification_status.slice(1)})})]})]})})]}),s.jsxs("form",{onSubmit:I,children:[s.jsxs(h,{children:[s.jsx(x,{children:s.jsx(u,{children:"Basic Information"})}),s.jsxs(j,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(t,{htmlFor:"location",children:"Location"}),s.jsx(n,{id:"location",value:a.location,onChange:e=>r({...a,location:e.target.value}),placeholder:"e.g., Los Angeles, CA",className:"mt-2"})]}),s.jsxs("div",{children:[s.jsx(t,{htmlFor:"bio",children:"Bio"}),s.jsx(H,{id:"bio",value:a.bio,onChange:e=>r({...a,bio:e.target.value}),placeholder:"Tell us about your studio...",rows:6,className:"mt-2"})]}),s.jsxs("div",{children:[s.jsx(t,{htmlFor:"avatar",children:"Avatar"}),s.jsxs("div",{className:"mt-2 space-y-2",children:[s.jsx(n,{id:"avatar",type:"file",accept:"image/*",onChange:E}),w&&s.jsx("img",{src:w,alt:"Avatar preview",className:"h-24 w-24 rounded-full object-cover border-2 border-primary/50"})]})]})]})]}),s.jsxs(h,{children:[s.jsx(x,{children:s.jsx(u,{children:"Associations"})}),s.jsxs(j,{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(n,{placeholder:"Add an association (e.g., VES, MPC, Framestore)",value:b,onChange:e=>k(e.target.value),onKeyPress:e=>e.key==="Enter"&&(e.preventDefault(),L())}),s.jsx(f,{type:"button",onClick:L,size:"sm",children:s.jsx(W,{className:"h-4 w-4"})})]}),s.jsx("div",{className:"space-y-2",children:a.associations.map((e,l)=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-secondary rounded",children:[s.jsx("span",{className:"text-sm",children:e}),s.jsx(f,{type:"button",variant:"ghost",size:"sm",onClick:()=>z(l),children:s.jsx($,{className:"h-4 w-4"})})]},l))})]})]}),s.jsxs(h,{children:[s.jsx(x,{children:s.jsx(u,{children:"Social Links"})}),s.jsxs(j,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(t,{htmlFor:"twitter",children:"Twitter URL"}),s.jsx(n,{id:"twitter",type:"url",value:a.social_links.twitter,onChange:e=>r({...a,social_links:{...a.social_links,twitter:e.target.value}}),placeholder:"https://twitter.com/yourhandle",className:"mt-2"})]}),s.jsxs("div",{children:[s.jsx(t,{htmlFor:"linkedin",children:"LinkedIn URL"}),s.jsx(n,{id:"linkedin",type:"url",value:a.social_links.linkedin,onChange:e=>r({...a,social_links:{...a.social_links,linkedin:e.target.value}}),placeholder:"https://linkedin.com/company/yourcompany",className:"mt-2"})]}),s.jsxs("div",{children:[s.jsx(t,{htmlFor:"instagram",children:"Instagram URL"}),s.jsx(n,{id:"instagram",type:"url",value:a.social_links.instagram,onChange:e=>r({...a,social_links:{...a.social_links,instagram:e.target.value}}),placeholder:"https://instagram.com/yourhandle",className:"mt-2"})]}),s.jsxs("div",{children:[s.jsx(t,{htmlFor:"website",children:"Website URL"}),s.jsx(n,{id:"website",type:"url",value:a.social_links.website,onChange:e=>r({...a,social_links:{...a.social_links,website:e.target.value}}),placeholder:"https://yourwebsite.com",className:"mt-2"})]})]})]}),s.jsxs(h,{children:[s.jsx(x,{children:s.jsx(u,{children:"Brand Colors"})}),s.jsx(j,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(t,{htmlFor:"primary-color",children:"Primary Color"}),s.jsx(n,{id:"primary-color",type:"color",value:a.brand_colors.primary,onChange:e=>r({...a,brand_colors:{...a.brand_colors,primary:e.target.value}}),className:"h-10 mt-2"})]}),s.jsxs("div",{children:[s.jsx(t,{htmlFor:"secondary-color",children:"Secondary Color"}),s.jsx(n,{id:"secondary-color",type:"color",value:a.brand_colors.secondary,onChange:e=>r({...a,brand_colors:{...a.brand_colors,secondary:e.target.value}}),className:"h-10 mt-2"})]})]})})]}),s.jsxs("div",{className:"flex gap-4 justify-end",children:[s.jsx(f,{type:"button",variant:"outline",onClick:()=>p("/dashboard"),disabled:N,children:"Cancel"}),s.jsx(f,{type:"submit",disabled:N,children:N?s.jsxs(s.Fragment,{children:[s.jsx(_,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):"Save Changes"})]})]})]})})]})};export{is as default};
